function Banners(){}Banners.prototype.loadData=function(){var r=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code)for(var e=n.data,a=0;a<e.length;a++){var t=e[a];r.createBannerEvent(t)}}})},Banners.prototype.createBannerEvent=function(n){var e=this,a=template("banner-item",{banner:n}),t=$(".banner-list-group"),r=null;r=n?(t.append(a),t.find(".banner-item:last")):(t.prepend(a),t.find(".banner-item:first")),e.addImageSelectEvent(r),e.addRemoveEvent(r),e.addSaveBannerEvent(r)},Banners.prototype.listenAddBannersEvent=function(){var n=this;$("#add-banner-btn").click(function(){6<=$(".banner-list-group").children().length?window.messageBox.showInfo("最多只能添加6张轮播图!!!"):n.createBannerEvent()})},Banners.prototype.addImageSelectEvent=function(n){var a=n.find(".thumbnail"),e=n.find(".image-input");a.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;a.attr("src",e)}}})})},Banners.prototype.addRemoveEvent=function(e){e.find("#close-btn").click(function(){var n=e.attr("data-banner-id");n?xfzalert.alertConfirm({text:"您确定要删除这个轮播图吗? ",confirmCallback:function(){xfzajax.post({url:"/cms/delete_banner/",data:{banner_id:n},success:function(n){200===n.code&&(e.remove(),window.messageBox.showSuccess("轮播图删除成功! "))}})}}):e.remove()})},Banners.prototype.addSaveBannerEvent=function(t){var n=t.find(".save-btn"),r=t.find(".thumbnail"),i=t.find('input[name="priority"]'),o=t.find('input[name="link-to"]'),s=t.find('span[class="priority"]'),c=t.attr("data-banner-id"),d="";c&&(d="/cms/edit_banner/"),d="/cms/add_banner/",n.click(function(){var n=r.attr("src"),e=i.val(),a=o.val();xfzajax.post({url:d,data:{image_url:n,priority:e,link_to:a,pk:c},success:function(n){200===n.code&&(c?window.messageBox.showSuccess("轮播图修改成功! "):(c=n.data.banner_id,t.attr("data-banner-id",c),window.messageBox.showSuccess("轮播图添加完成! ")),s.text("优先级: "+e))}})})},Banners.prototype.run=function(){this.listenAddBannersEvent(),this.loadData()},$(function(){(new Banners).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInByb3RvdHlwZSIsImxvYWREYXRhIiwic2VsZiIsInRoaXMiLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwic3VjY2VzcyIsInJlc3VsdCIsImJhbm5lcnMiLCJpIiwibGVuZ3RoIiwiYmFubmVyIiwiY3JlYXRlQmFubmVyRXZlbnQiLCJ0cGwiLCJ0ZW1wbGF0ZSIsImJhbm5lckxpc3RHcm91cCIsIiQiLCJiYW5uZXJJdGVtIiwiYXBwZW5kIiwiZmluZCIsInByZXBlbmQiLCJhZGRJbWFnZVNlbGVjdEV2ZW50IiwiYWRkUmVtb3ZlRXZlbnQiLCJhZGRTYXZlQmFubmVyRXZlbnQiLCJsaXN0ZW5BZGRCYW5uZXJzRXZlbnQiLCJjbGljayIsImNoaWxkcmVuIiwid2luZG93IiwibWVzc2FnZUJveCIsInNob3dJbmZvIiwiaW1hZ2UiLCJpbWFnZUlucHV0IiwiY2hhbmdlIiwiZmlsZSIsImZpbGVzIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInBvc3QiLCJkYXRhIiwicHJvY2Vzc0RhdGEiLCJjb250ZW50VHlwZSIsImF0dHIiLCJiYW5uZXJJZCIsInhmemFsZXJ0IiwiYWxlcnRDb25maXJtIiwidGV4dCIsImNvbmZpcm1DYWxsYmFjayIsImJhbm5lcl9pZCIsInJlbW92ZSIsInNob3dTdWNjZXNzIiwic2F2ZUJ0biIsImltYWdlVGFnIiwicHJpb3JpdHlUYWciLCJsaW5rdG9UYWciLCJwcmlvcml0eVNwYW4iLCJpbWFnZV91cmwiLCJwcmlvcml0eSIsInZhbCIsImxpbmtfdG8iLCJwayIsInJ1biJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsV0FLVEEsUUFBUUMsVUFBVUMsU0FBVyxXQUN6QixJQUFJQyxFQUFPQyxLQUNYQyxRQUFRQyxJQUFJLENBQ1JDLElBQU8sb0JBQ1BDLFFBQVcsU0FBVUMsR0FDakIsR0FBdUIsTUFBbkJBLEVBQWEsS0FFYixJQURBLElBQUlDLEVBQVVELEVBQWEsS0FDbEJFLEVBQUks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R1RnQixFQUFFLFlBQ2dCLElBQUlsQixTQUNWOEQiLCJmaWxlIjoiYmFubmVycy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBCYW5uZXJzKCkge1xuXG59XG5cbi8qIOi9ruaSreWbvuWxleekuuWHveaVsCAqL1xuQmFubmVycy5wcm90b3R5cGUubG9hZERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHhmemFqYXguZ2V0KHtcbiAgICAgICAgJ3VybCc6ICcvY21zL2Jhbm5lcl9saXN0LycsXG4gICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYmFubmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYmFubmVyID0gYmFubmVyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jcmVhdGVCYW5uZXJFdmVudChiYW5uZXIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn07XG5cbi8qIOi/meaYr+e7mei9ruaSreWbvuWBmueahOWKn+iDveWHveaVsCxcbiAgICAxLuWmguaenOaYr+a3u+WKoOi9ruaSreWbvizlsLHkuIDnm7Tlh7rnjrDlnKjmnIDkuIrpnaIsXG4gICAgMi7lpoLmnpzmmK/lsZXnpLrova7mkq3lm74s5bCx5oyJ54Wn6aG65bqPLOacgOWFiOa3u+WKoOeahOWxleekuuWcqOacgOS4iumdoizmnIDov5Hmt7vliqDnmoTlsZXnpLrlnKjmnIDkuIvmlrkgKi9cbkJhbm5lcnMucHJvdG90eXBlLmNyZWF0ZUJhbm5lckV2ZW50ID0gZnVuY3Rpb24gKGJhbm5lcikge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdHBsID0gdGVtcGxhdGUoXCJiYW5uZXItaXRlbVwiLCB7XCJiYW5uZXJcIjogYmFubmVyfSk7XG4gICAgdmFyIGJhbm5lckxpc3RHcm91cCA9ICQoJy5iYW5uZXItbGlzdC1ncm91cCcpO1xuICAgIHZhciBiYW5uZXJJdGVtID0gbnVsbDtcbiAgICBpZiAoYmFubmVyKSB7XG4gICAgICAgIGJhbm5lckxpc3RHcm91cC5hcHBlbmQodHBsKTtcbiAgICAgICAgYmFubmVySXRlbSA9IGJhbm5lckxpc3RHcm91cC5maW5kKCcuYmFubmVyLWl0ZW06bGFzdCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGJhbm5lckxpc3RHcm91cC5wcmVwZW5kKHRwbCk7XG4gICAgICAgIGJhbm5lckl0ZW0gPSBiYW5uZXJMaXN0R3JvdXAuZmluZCgnLmJhbm5lci1pdGVtOmZpcnN0Jyk7XG4gICAgfVxuICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcbiAgICBzZWxmLmFkZFJlbW92ZUV2ZW50KGJhbm5lckl0ZW0pO1xuICAgIHNlbGYuYWRkU2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xufTtcblxuLyog5re75Yqg6L2u5pKt5Zu+ICovXG5CYW5uZXJzLnByb3RvdHlwZS5saXN0ZW5BZGRCYW5uZXJzRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBhZGRCdG4gPSAkKFwiI2FkZC1iYW5uZXItYnRuXCIpO1xuICAgIGFkZEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBiYW5uZXJMaXN0R3JvdXAgPSAkKCcuYmFubmVyLWxpc3QtZ3JvdXAnKTtcbiAgICAgICAgdmFyIGxlbiA9IGJhbm5lckxpc3RHcm91cC5jaGlsZHJlbigpLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA+PSA2KSB7XG4gICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93SW5mbygn5pyA5aSa5Y+q6IO95re75YqgNuW8oOi9ruaSreWbviEhIScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuY3JlYXRlQmFubmVyRXZlbnQoKVxuICAgIH0pO1xufTtcblxuLyog6L2u5pKt5Zu+5Lit5re75Yqg5Zu+54mH55qE5Ye95pWwICovXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRJbWFnZVNlbGVjdEV2ZW50ID0gZnVuY3Rpb24gKGJhbm5lckl0ZW0pIHtcbiAgICB2YXIgaW1hZ2UgPSBiYW5uZXJJdGVtLmZpbmQoJy50aHVtYm5haWwnKTtcbiAgICAvKiBpbWFnZUlucHV0IOS5n+WPr+S7pemAmui/h2Jhbm5lckl0ZW3mnaXpgInmi6ks5Zug5Li6bGlzdGVuQWRkQmFubmVyc0V2ZW505Lit56Gu5a6a5q+P5qyh5Y+q6IO96YCJ5oup5pyA5LiK6Z2i55qE5a+56LGhICovXG4gICAgdmFyIGltYWdlSW5wdXQgPSBiYW5uZXJJdGVtLmZpbmQoJy5pbWFnZS1pbnB1dCcpO1xuICAgIGltYWdlLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyog5Zug5Li6aW1n5qCH562+5rKh5pyJ5omT5byA5paH5Lu255qE6IO95YqbLOWPquaciWlucHV05qCH562+5Y+v5LulLFxuICAgICAgICDlvZPnlKjmiLfngrnlh7vlm77niYcs54S25ZCOanPku6PnoIHmiafooYzngrnlh7tpbnB1dOagh+etvueahOS6i+S7tiAqL1xuICAgICAgICAvLyB2YXIgdGhhdCA9ICQodGhpcyk7XG4gICAgICAgIC8qIOWboOS4uuacieW+iOWkmuS4qui9ruaSreWbvueJhyzlubbkuJTpg73nlKhjbGFzc+i/m+ihjOagh+azqCzkvJrlr7zoh7TlhrLnqoEsXG4gICAgICAgIOaJgOS7pemcgOimgeS9v+eUqOWIsCzlvZPkvaDpgInmi6nmn5DkuKrlm77niYfml7Ys5L2g55qE5YWE5byf5qCH562+aW5wdXTmiafooYzngrnlh7vkuovku7YgKi9cbiAgICAgICAgLy8gdmFyIGltYWdlSW5wdXQgPSB0aGF0LnNpYmxpbmdzKCcuaW1hZ2UtaW5wdXQnKTtcbiAgICAgICAgaW1hZ2VJbnB1dC5jbGljaygpO1xuICAgIH0pO1xuXG4gICAgLyog5Zug5Li65omT5byA5paH5Lu25aS55LitLOmAieaLqeafkOS4quaWh+S7tuaIluWbvueJh+aYr+WxnuS6jmNoYW5nZeS6i+S7tiAqL1xuICAgIGltYWdlSW5wdXQuY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyog5Luj6KGo6YCJ5oup55qE5paH5Lu2KOWbvueJhykgKi9cbiAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdO1xuICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7XG4gICAgICAgIHhmemFqYXgucG9zdCh7XG4gICAgICAgICAgICAndXJsJzogJy9jbXMvdXBsb2FkX2ZpbGUvJyxcbiAgICAgICAgICAgICdkYXRhJzogZm9ybURhdGEsXG4gICAgICAgICAgICAvKiDlkYror4lKUXVlcnnvvIzov5nmmK/kuIDkuKrmlofku7bvvIzkuI3mmK/kuIDkuKrmma7pgJrnmoTmlofmnKzlrZfnrKbkuLLvvIzkuI3pnIDopoHkvaDlho3ljrvlpITnkIYgKi9cbiAgICAgICAgICAgICdwcm9jZXNzRGF0YSc6IGZhbHNlLFxuICAgICAgICAgICAgLyrpu5jorqTkvb/nlKjmlofku7bnmoTmoLzlvI8qL1xuICAgICAgICAgICAgJ2NvbnRlbnRUeXBlJzogZmFsc2UsXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gcmVzdWx0WydkYXRhJ11bJ3VybCddO1xuICAgICAgICAgICAgICAgICAgICBpbWFnZS5hdHRyKCdzcmMnLCB1cmwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG4vKiDova7mkq3lm77kuK3lhbPpl63mjInpkq7nmoTlh73mlbAgKi9cbkJhbm5lcnMucHJvdG90eXBlLmFkZFJlbW92ZUV2ZW50ID0gZnVuY3Rpb24gKGJhbm5lckl0ZW0pIHtcbiAgICB2YXIgY2xvc2VCdG4gPSBiYW5uZXJJdGVtLmZpbmQoXCIjY2xvc2UtYnRuXCIpO1xuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJhbm5lcklkID0gYmFubmVySXRlbS5hdHRyKCdkYXRhLWJhbm5lci1pZCcpO1xuICAgICAgICBpZiAoYmFubmVySWQpIHtcbiAgICAgICAgICAgIHhmemFsZXJ0LmFsZXJ0Q29uZmlybSh7XG4gICAgICAgICAgICAgICAgJ3RleHQnOiAn5oKo56Gu5a6a6KaB5Yig6Zmk6L+Z5Liq6L2u5pKt5Zu+5ZCXPyAnLFxuICAgICAgICAgICAgICAgICdjb25maXJtQ2FsbGJhY2snOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHhmemFqYXgucG9zdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAndXJsJzogJy9jbXMvZGVsZXRlX2Jhbm5lci8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Jhbm5lcl9pZCc6IGJhbm5lcklkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoXCLova7mkq3lm77liKDpmaTmiJDlip8hIFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuLyog6L2u5pKt5Zu+5Lit5L+d5a2Y6L2u5pKt5Zu+55qE5Ye95pWwICovXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRTYXZlQmFubmVyRXZlbnQgPSBmdW5jdGlvbiAoYmFubmVySXRlbSkge1xuICAgIHZhciBzYXZlQnRuID0gYmFubmVySXRlbS5maW5kKCcuc2F2ZS1idG4nKTtcbiAgICB2YXIgaW1hZ2VUYWcgPSBiYW5uZXJJdGVtLmZpbmQoJy50aHVtYm5haWwnKTtcbiAgICB2YXIgcHJpb3JpdHlUYWcgPSBiYW5uZXJJdGVtLmZpbmQoJ2lucHV0W25hbWU9XCJwcmlvcml0eVwiXScpO1xuICAgIHZhciBsaW5rdG9UYWcgPSBiYW5uZXJJdGVtLmZpbmQoJ2lucHV0W25hbWU9XCJsaW5rLXRvXCJdJyk7XG4gICAgdmFyIHByaW9yaXR5U3BhbiA9IGJhbm5lckl0ZW0uZmluZCgnc3BhbltjbGFzcz1cInByaW9yaXR5XCJdJyk7XG4gICAgdmFyIGJhbm5lcklkID0gYmFubmVySXRlbS5hdHRyKCdkYXRhLWJhbm5lci1pZCcpO1xuICAgIHZhciB1cmwgPSAnJztcbiAgICBpZiAoYmFubmVySWQpIHtcbiAgICAgICAgdXJsID0gJy9jbXMvZWRpdF9iYW5uZXIvJ1xuICAgIH1cbiAgICB7XG4gICAgICAgIHVybCA9ICcvY21zL2FkZF9iYW5uZXIvJ1xuICAgIH1cbiAgICBzYXZlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGltYWdlX3VybCA9IGltYWdlVGFnLmF0dHIoXCJzcmNcIik7XG4gICAgICAgIHZhciBwcmlvcml0eSA9IHByaW9yaXR5VGFnLnZhbCgpO1xuICAgICAgICB2YXIgbGlua190byA9IGxpbmt0b1RhZy52YWwoKTtcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOiB1cmwsXG4gICAgICAgICAgICAnZGF0YSc6IHtcbiAgICAgICAgICAgICAgICAnaW1hZ2VfdXJsJzogaW1hZ2VfdXJsLFxuICAgICAgICAgICAgICAgICdwcmlvcml0eSc6IHByaW9yaXR5LFxuICAgICAgICAgICAgICAgICdsaW5rX3RvJzogbGlua190byxcbiAgICAgICAgICAgICAgICAncGsnOiBiYW5uZXJJZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiYW5uZXJJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoXCLova7mkq3lm77kv67mlLnmiJDlip8hIFwiKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySWQgPSByZXN1bHRbJ2RhdGEnXVsnYmFubmVyX2lkJ107XG4gICAgICAgICAgICAgICAgICAgICAgICBiYW5uZXJJdGVtLmF0dHIoJ2RhdGEtYmFubmVyLWlkJywgYmFubmVySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+i9ruaSreWbvua3u+WKoOWujOaIkCEgJylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKiDml6DorrrmmK/mlrDlop7ov5jmmK/kv67mlLnpg73opoHljrvmm7TmlLnkvJjlhYjnuqcgKi9cbiAgICAgICAgICAgICAgICAgICAgcHJpb3JpdHlTcGFuLnRleHQoXCLkvJjlhYjnuqc6IFwiICsgcHJpb3JpdHkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KTtcbn07XG5cbkJhbm5lcnMucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5saXN0ZW5BZGRCYW5uZXJzRXZlbnQoKTtcbiAgICBzZWxmLmxvYWREYXRhKCk7XG59O1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYmFubmVycyA9IG5ldyBCYW5uZXJzKCk7XG4gICAgYmFubmVycy5ydW4oKTtcbn0pOyJdfQ==
